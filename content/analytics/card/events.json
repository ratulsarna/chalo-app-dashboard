{
  "flowId": "card",
  "flowName": "Card operations & recharge",
  "description": "Complete analytics map for card management operations including Chalo Card linking/recharge, NCMC balance/recharge, card transactions, and tap operations.",
  "propertyDefinitions": {
    "cardNumber": {
      "type": "string",
      "description": "Full card number (Chalo Card or NCMC card)."
    },
    "maskedCardNumber": {
      "type": "string",
      "description": "Masked version of card number for display."
    },
    "cardNo": {
      "type": "string",
      "description": "Card number attribute (alternate naming in some contexts)."
    },
    "card no": {
      "type": "string",
      "description": "NCMC card number attribute (legacy key with spaces)."
    },
    "kitNo": {
      "type": "string",
      "description": "Kit number for NCMC cards."
    },
    "kit no": {
      "type": "string",
      "description": "NCMC kit number attribute (legacy key with spaces)."
    },
    "cardType": {
      "type": "string",
      "description": "Type of card (e.g., Chalo Card, NCMC)."
    },
    "cardIssuedOn": {
      "type": "string",
      "description": "Issue date of the card."
    },
    "cardBalance": {
      "type": "number",
      "description": "Current balance on the card."
    },
    "isCardRechargeEnabled": {
      "type": "boolean",
      "description": "Whether recharge is enabled for this card."
    },
    "isCardBlocked": {
      "type": "boolean",
      "description": "Whether the card is currently blocked."
    },
    "rechargeLimit": {
      "type": "number",
      "description": "Maximum recharge limit for the card."
    },
    "cardCity": {
      "type": "string",
      "description": "City where the card is valid."
    },
    "cardAgency": {
      "type": "string",
      "description": "Transit agency associated with the card."
    },
    "chaloCardPassName": {
      "type": "string",
      "description": "Name of active pass on Chalo Card."
    },
    "expiryTime": {
      "type": "number",
      "description": "Pass expiry timestamp in milliseconds."
    },
    "remainingTrips": {
      "type": "number",
      "description": "Number of trips remaining on the active pass."
    },
    "maxPricePerTrip": {
      "type": "number",
      "description": "Maximum price allowed per trip on the pass."
    },
    "maxTripsPerDay": {
      "type": "number",
      "description": "Maximum number of trips allowed per day."
    },
    "activationCode": {
      "type": "string",
      "description": "Card activation/linking code entered by user."
    },
    "cardLinkingErrorReason": {
      "type": "string",
      "description": "Reason for card linking failure.",
      "values": [
        "API_CALL_AUTHORISATION_ERROR",
        "CARD_LINKED_TO_ANOTHER_NUMBER",
        "CARD_NOT_REGISTERED_IN_CURR_CITY",
        "ERROR_RESPONSE_PARSING_ERROR",
        "INVALID_CARD_NUMBER",
        "INVALID_LINK_CODE",
        "KYC_NOT_DONE",
        "NO_INTERNET_ERROR",
        "NO_UPDATE_IN_DATA_BASED_ON_ETAG",
        "REQUEST_CANCELLATION_ERROR",
        "SERVER_ERROR",
        "SUCCESS_RESPONSE_PARSING_ERROR",
        "UNEXPECTED_EXCEPTION_ERROR",
        "UNKNOWN_ERROR"
      ]
    },
    "chaloCardInfoFetchFailedReason": {
      "type": "string",
      "description": "Reason enum when fetching card info fails.",
      "values": [
        "API_CALL_FAILED",
        "FETCH_NCMC_CARD_ERROR",
        "FETCH_NCMC_CARD_TIMEOUT_ERROR",
        "NO_CARD_LINKED"
      ]
    },
    "refreshChaloCardInfoSource": {
      "type": "string",
      "description": "Source that triggered card info refresh.",
      "values": [
        "CARD_ACTIVATE_REFRESH",
        "CARD_LINK_REFRESH",
        "EMPTY_ERROR_STATE_RETRY",
        "FETCH_FAILED_SNACKBAR_RETRY",
        "REFRESH_BTN"
      ]
    },
    "rechargeAmount": {
      "type": "number",
      "description": "Amount selected for recharge."
    },
    "recharge amount": {
      "type": "string",
      "description": "Recharge amount attribute used by NCMC flows (legacy key with spaces; value is stringified)."
    },
    "rechargeStatus": {
      "type": "string",
      "description": "Status of the recharge operation."
    },
    "cardTransactionId": {
      "type": "string",
      "description": "Transaction ID for card operations."
    },
    "transactionId": {
      "type": "string",
      "description": "Generic transaction identifier."
    },
    "transactionType": {
      "type": "string",
      "description": "Type of transaction (RECHARGE, PASS_PURCHASE, TICKET, MERCHANT, UNKNOWN).",
      "values": [
        "MERCHANT",
        "PASS_PURCHASE",
        "RECHARGE",
        "TICKET",
        "UNKNOWN"
      ]
    },
    "orderId": {
      "type": "string",
      "description": "Backend order ID for recharge."
    },
    "chaloOrderId": {
      "type": "string",
      "description": "Chalo-specific order ID."
    },
    "failureReason": {
      "type": "string",
      "description": "Generic failure reason message."
    },
    "rechargeOrderFailureReason": {
      "type": "string",
      "description": "Specific reason for recharge order creation failure."
    },
    "errorCode": {
      "type": "string",
      "description": "Error code returned from API or validation."
    },
    "errorType": {
      "type": "string",
      "description": "Type of error (below min, not in multiples, limit exceeded)."
    },
    "isSuccessful": {
      "type": "boolean",
      "description": "Whether the operation completed successfully."
    },
    "paymentTime": {
      "type": "string",
      "description": "Timestamp of payment completion."
    },
    "paymentStatus": {
      "type": "string",
      "description": "Status of payment (success, failed, pending)."
    },
    "amount": {
      "type": "string",
      "description": "Generic amount field (often stringified in KMP)."
    },
    "ocr recharge delay copy": {
      "type": "string",
      "description": "Copy text shown about recharge delay after payment."
    },
    "isRefreshResult": {
      "type": "boolean",
      "description": "Whether this result came from a refresh action."
    },
    "errorMessage": {
      "type": "string",
      "description": "Error message text."
    },
    "card option": {
      "type": "string",
      "description": "Which card option was clicked on home screen."
    },
    "chaloCardRechargeConfigFetchFailedReason": {
      "type": "string",
      "description": "Reason for recharge configuration fetch failure.",
      "values": [
        "API_CALL_AUTHORISATION_ERROR",
        "ERROR_RESPONSE_PARSING_ERROR",
        "NO_ACTIVE_RECHARGE_CONFIG_FOUND",
        "NO_INTERNET_ERROR",
        "NO_UPDATE_IN_DATA_BASED_ON_ETAG",
        "REQUEST_CANCELLATION_ERROR",
        "SERVER_ERROR",
        "SUCCESS_RESPONSE_PARSING_ERROR",
        "UNEXPECTED_EXCEPTION_ERROR",
        "UNKNOWN",
        "UNKNOWN_ERROR"
      ]
    },
    "online recharge balance": {
      "type": "string",
      "description": "Online recharge balance for NCMC card (stringified in KMP NCMC flows)."
    },
    "ncmc recharge mode": {
      "type": "string",
      "description": "Mode of NCMC recharge (online/offline).",
      "values": [
        "OFFLINE",
        "ONLINE"
      ]
    },
    "offlineBalance": {
      "type": "string",
      "description": "Offline balance on NCMC card (stringified in KMP tap flow)."
    },
    "topUpAmount": {
      "type": "string",
      "description": "Amount topped up in tap operation (stringified in KMP tap flow)."
    },
    "rrn": {
      "type": "string",
      "description": "Retrieval Reference Number for tap transactions."
    },
    "status": {
      "type": "string",
      "description": "Verification status in tap operations (Terminated, Declined, Failed, SelectNext, Unknown)."
    },
    "resultCode": {
      "type": "string",
      "description": "Result code from tap operation."
    },
    "message": {
      "type": "string",
      "description": "Result message from tap operation."
    },
    "reason": {
      "type": "string",
      "description": "Reason for failure or unavailability."
    },
    "configId": {
      "type": "string",
      "description": "Configuration ID for card product."
    },
    "productName": {
      "type": "string",
      "description": "Name of the card product."
    },
    "isActive": {
      "type": "boolean",
      "description": "Whether the product/config is active."
    },
    "productType": {
      "type": "string",
      "description": "Type of product."
    },
    "productSubType": {
      "type": "string",
      "description": "Sub-type of product."
    }
  },
  "stages": [
    {
      "name": "Home & Navigation",
      "description": "Entry points from home screen and navigation drawer.",
      "events": [
        "ocr homescreen card recharge card",
        "ocr tutorial bottomsheet displayed",
        "ocr tutorial bottomsheet next clicked"
      ]
    },
    {
      "name": "Chalo Card Info",
      "description": "Card information screen showing balance, passes, and transaction history.",
      "events": [
        "chalo card info screen opened",
        "chalo card info fetch success",
        "chalo card info fetch failed",
        "no linked chalo card found",
        "refresh chalo card info clicked",
        "chalo card info add money clicked",
        "chalo card buy new card btn clicked",
        "chalo card info show transaction history btn clicked",
        "chalo card info link card tut link btn clicked",
        "chalo card info active pass card clicked"
      ]
    },
    {
      "name": "Chalo Card Linking",
      "description": "Flow for linking a new Chalo Card using activation code.",
      "events": [
        "chalo card linking screen opened",
        "chalocard link code proceed btn clicked",
        "chalo card linking failed",
        "chalocard linking success"
      ]
    },
    {
      "name": "Enter Card Details",
      "description": "Screen for entering card details before recharge.",
      "events": [
        "ocr cardDetails next clicked",
        "ocr card validity checked"
      ]
    },
    {
      "name": "Chalo Card Recharge Amount",
      "description": "Enter recharge amount, validate, and create order for Chalo Card recharge.",
      "events": [
        "chalo card enter recharge amount screen opened",
        "chalo card info fetch success",
        "chalo card info fetch failed",
        "chalo card recharge config fetch failed",
        "chalo card recharge proceed btn clicked",
        "ocr recharge amount error",
        "terms and conditions open",
        "terms accept",
        "terms cancel",
        "ocr order created",
        "ocr order creation failed",
        "chalo card recharge error action btn clicked",
        "chalo card info link card tut link btn clicked"
      ]
    },
    {
      "name": "Chalo Card Post-Payment",
      "description": "Payment success and summary screens after Chalo Card recharge.",
      "events": [
        "ocr payment success activity open",
        "ocr payment success ok clicked",
        "ocr payment success recharge details clicked",
        "ocr payment summary activity open"
      ]
    },
    {
      "name": "Card Transactions History",
      "description": "View and interact with card transaction history.",
      "events": [
        "chalo card transactions opened",
        "chalo card transactions fetch result",
        "chalo card transactions retry clicked",
        "chalo card transactions refresh clicked",
        "chalo card transaction clicked",
        "chalo card transactions email all clicked"
      ]
    },
    {
      "name": "NCMC Online Recharge",
      "description": "NCMC card online balance recharge flow.",
      "events": [
        "ncmc load balance view created",
        "ncmc load balance next clicked",
        "ncmc tnc accepted loading",
        "ncmc online recharge order created",
        "ncmc recharge api error",
        "ncmc online recharge completed"
      ]
    },
    {
      "name": "NCMC Offline Recharge",
      "description": "NCMC card offline balance recharge flow.",
      "events": [
        "ncmc load balance view created",
        "ncmc load balance next clicked",
        "ncmc tnc accepted loading",
        "ncmc offline recharge success",
        "ncmc recharge api error"
      ]
    },
    {
      "name": "NCMC Tap Operations",
      "description": "NFC tap operations for NCMC card validation and top-up.",
      "events": [
        "uvik intent hash creation failed",
        "ncmc tap operation success",
        "ncmc tap operation failure",
        "ncmc tap operation result unavailable",
        "ncmc tap transaction failed"
      ]
    },
    {
      "name": "Checkout Payment (Card)",
      "description": "Payment processing events specific to card recharge.",
      "events": [
        "card screen opened",
        "card details submitted",
        "online card recharge payment successful",
        "online card recharge payment failed",
        "ncmc recharge payment successful",
        "ncmc recharge payment failed"
      ]
    },
    {
      "name": "Notifications",
      "description": "Card-related push notifications.",
      "events": [
        "chalo card transaction notification received"
      ]
    }
  ],
  "events": [
    {
      "name": "terms accept",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "User accepts terms and conditions.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "isCardBlocked"
        },
        {
          "property": "configId"
        },
        {
          "property": "productName"
        },
        {
          "property": "isActive"
        },
        {
          "property": "productType"
        },
        {
          "property": "productSubType"
        },
        {
          "property": "cardAgency"
        },
        {
          "property": "cardCity"
        }
      ],
      "notes": "Event name is `AnalyticsEventConstants.ACCEPT_TERMS` (`terms accept`). Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "terms cancel",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "User cancels terms and conditions dialog.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "isCardBlocked"
        },
        {
          "property": "configId"
        },
        {
          "property": "productName"
        },
        {
          "property": "isActive"
        },
        {
          "property": "productType"
        },
        {
          "property": "productSubType"
        },
        {
          "property": "cardAgency"
        },
        {
          "property": "cardCity"
        }
      ],
      "notes": "Event name is `AnalyticsEventConstants.CANCEL_TERMS` (`terms cancel`). Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "card details submitted",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "cardDetailsScreen",
      "description": "User submits card details for payment."
    },
    {
      "name": "card screen opened",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "cardDetailsScreen",
      "description": "Card details screen opened in checkout flow."
    },
    {
      "name": "chalo card buy new card btn clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps the buy new card button.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties."
    },
    {
      "name": "chalo card enter recharge amount screen opened",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "Various (passed from caller)",
      "description": "Recharge amount entry screen opens.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "isCardBlocked"
        }
      ],
      "notes": "Properties are derived from `ChaloCardDetails.addAnalyticsEventPropertiesToMap()` (passed from caller)."
    },
    {
      "name": "chalo card info active pass card clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps on the active pass card to view details.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        },
        {
          "property": "chaloCardPassName"
        },
        {
          "property": "expiryTime"
        },
        {
          "property": "remainingTrips"
        },
        {
          "property": "maxPricePerTrip"
        },
        {
          "property": "maxTripsPerDay"
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties."
    },
    {
      "name": "chalo card info add money clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps the add money button to start recharge flow.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "cardBalance"
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties."
    },
    {
      "name": "chalo card info fetch failed",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "Failed to fetch card information.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        },
        {
          "property": "chaloCardInfoFetchFailedReason",
          "context": "Failure reason enum."
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties plus `chaloCardInfoFetchFailedReason`."
    },
    {
      "name": "chalo card info fetch failed",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Card info fetch failed on recharge amount screen.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "chaloCardInfoFetchFailedReason",
          "context": "Failure reason enum."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `chaloCardInfoFetchFailedReason`."
    },
    {
      "name": "chalo card info fetch success",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "Successfully fetched card information from backend.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "isCardBlocked"
        },
        {
          "property": "chaloCardPassName",
          "context": "If active pass exists."
        },
        {
          "property": "expiryTime",
          "context": "If active pass exists."
        },
        {
          "property": "remainingTrips",
          "context": "If active pass exists."
        },
        {
          "property": "maxPricePerTrip",
          "context": "If active pass exists."
        },
        {
          "property": "maxTripsPerDay",
          "context": "If active pass exists."
        }
      ],
      "notes": "Includes all card details properties plus active pass properties if applicable."
    },
    {
      "name": "chalo card info fetch success",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Card info fetched successfully on recharge amount screen.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "chalo card info link card tut link btn clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps the link card tutorial link.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties."
    },
    {
      "name": "chalo card info link card tut link btn clicked",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "User taps link card tutorial link from recharge screen.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "chalo card info screen opened",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "Various (tracked in component initialization)",
      "description": "Card information screen opens with card details.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "isCardBlocked"
        },
        {
          "property": "chaloCardPassName",
          "context": "If active pass exists."
        },
        {
          "property": "expiryTime",
          "context": "If active pass exists."
        },
        {
          "property": "remainingTrips",
          "context": "If active pass exists."
        },
        {
          "property": "maxPricePerTrip",
          "context": "If active pass exists."
        },
        {
          "property": "maxTripsPerDay",
          "context": "If active pass exists."
        }
      ]
    },
    {
      "name": "chalo card info show transaction history btn clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps to view transaction history.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties."
    },
    {
      "name": "chalo card linking failed",
      "component": "ChaloCardLinkCardComponent",
      "stage": "Chalo Card Linking",
      "source": "chalo card linking screen",
      "description": "Card linking operation failed.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "activationCode"
        },
        {
          "property": "cardLinkingErrorReason",
          "context": "Error reason from DataFetchOperationErrorReason or LinkChaloCardFailureReason."
        },
        {
          "property": "errorCode",
          "context": "Error code if available."
        }
      ],
      "notes": "Properties are derived from `ChaloCardLinkViewState.toAnalyticsPropertiesMap()` plus the failure-reason fields."
    },
    {
      "name": "chalo card linking screen opened",
      "component": "ChaloCardLinkCardComponent",
      "stage": "Chalo Card Linking",
      "source": "Various (passed from caller)",
      "description": "Card linking screen opens for user to enter activation code.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "activationCode"
        }
      ],
      "notes": "Properties are derived from `ChaloCardLinkViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "chalo card recharge config fetch failed",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Failed to fetch recharge configuration.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "chaloCardRechargeConfigFetchFailedReason",
          "context": "Configuration fetch failure reason."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `chaloCardRechargeConfigFetchFailedReason`."
    },
    {
      "name": "chalo card recharge error action btn clicked",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "User taps error action button.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "errorReason",
          "context": "Error reason that triggered the action."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `errorReason`."
    },
    {
      "name": "chalo card recharge proceed btn clicked",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "User taps proceed button with entered recharge amount.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "chalo card transaction clicked",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "CardTransactionsViewModel",
      "description": "User taps on a specific transaction to view details.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "transactionType",
          "context": "Type: RECHARGE, PASS_PURCHASE, TICKET, MERCHANT, UNKNOWN."
        },
        {
          "property": "transactionId"
        }
      ]
    },
    {
      "name": "chalo card transaction notification received",
      "component": "NotificationService",
      "stage": "Notifications",
      "source": "pushNotification",
      "description": "Push notification received for card transaction."
    },
    {
      "name": "chalo card transactions email all clicked",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "CardTransactionsViewModel",
      "description": "User taps to email all transactions."
    },
    {
      "name": "chalo card transactions fetch result",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "CardTransactionsViewModel",
      "description": "Result of fetching card transactions.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "isSuccessful",
          "context": "Whether fetch succeeded."
        },
        {
          "property": "errorMessage",
          "context": "Error message if failed."
        },
        {
          "property": "isRefreshResult",
          "context": "Whether this was a refresh operation."
        }
      ]
    },
    {
      "name": "chalo card transactions opened",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "Various (passed from caller)",
      "description": "Card transactions history screen opens.",
      "properties": [
        {
          "property": "cardNumber",
          "context": "Card number for which transactions are shown."
        }
      ]
    },
    {
      "name": "chalo card transactions refresh clicked",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "CardTransactionsViewModel",
      "description": "User pulls to refresh transactions list."
    },
    {
      "name": "chalo card transactions retry clicked",
      "component": "CardTransactionHistoryComponent",
      "stage": "Card Transactions History",
      "source": "CardTransactionsViewModel",
      "description": "User taps retry button after fetch failure."
    },
    {
      "name": "chalocard link code proceed btn clicked",
      "component": "ChaloCardLinkCardComponent",
      "stage": "Chalo Card Linking",
      "source": "chalo card linking screen",
      "description": "User submits the card activation code to link card.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "activationCode"
        }
      ],
      "notes": "Properties are derived from `ChaloCardLinkViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "chalocard linking success",
      "component": "ChaloCardLinkCardComponent",
      "stage": "Chalo Card Linking",
      "source": "chalo card linking screen",
      "description": "Card linked successfully.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "activationCode"
        }
      ],
      "notes": "Properties are derived from `ChaloCardLinkViewState.toAnalyticsPropertiesMap()`."
    },
    {
      "name": "ncmc load balance next clicked",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "User taps next after entering recharge amount.",
      "properties": [
        {
          "property": "online recharge balance",
          "context": "Online recharge balance (in subcurrency)."
        },
        {
          "property": "card no",
          "context": "NCMC card number."
        },
        {
          "property": "kit no",
          "context": "Kit number."
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount",
          "context": "Recharge amount (in subcurrency)."
        }
      ],
      "notes": "Properties are derived from `NCMCOnlineRechargeViewState.toAnalyticsParamsMap()`; note that NCMC uses spaced keys like `card no` and `recharge amount`."
    },
    {
      "name": "ncmc load balance next clicked",
      "component": "OfflineCardRechargeComponent",
      "stage": "NCMC Offline Recharge",
      "source": "ncmc offline balance recharge screen",
      "description": "User taps next after entering recharge amount.",
      "properties": [
        {
          "property": "online recharge balance",
          "context": "Online recharge balance (in subcurrency)."
        },
        {
          "property": "card no",
          "context": "NCMC card number."
        },
        {
          "property": "kit no",
          "context": "Kit number."
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount",
          "context": "Recharge amount (in subcurrency)."
        }
      ],
      "notes": "Properties are derived from `OfflineCardRechargeViewState.toAnalyticsParamsMap()`; note that NCMC uses spaced keys like `card no` and `recharge amount`."
    },
    {
      "name": "ncmc load balance view created",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "NCMC load balance screen view created.",
      "properties": [
        {
          "property": "online recharge balance",
          "context": "Online recharge balance (for online flow)."
        },
        {
          "property": "card no",
          "context": "NCMC card number."
        },
        {
          "property": "kit no",
          "context": "Kit number."
        },
        {
          "property": "ncmc recharge mode",
          "context": "Mode: 'online' or 'offline'."
        },
        {
          "property": "recharge amount",
          "context": "Recharge amount (in subcurrency)."
        }
      ],
      "notes": "Properties are derived from `NCMCOnlineRechargeViewState.toAnalyticsParamsMap()`; note that NCMC uses spaced keys like `card no` and `recharge amount`."
    },
    {
      "name": "ncmc load balance view created",
      "component": "OfflineCardRechargeComponent",
      "stage": "NCMC Offline Recharge",
      "source": "ncmc offline balance recharge screen",
      "description": "NCMC load balance screen view created.",
      "properties": [
        {
          "property": "online recharge balance",
          "context": "Online recharge balance (for online flow)."
        },
        {
          "property": "card no",
          "context": "NCMC card number."
        },
        {
          "property": "kit no",
          "context": "Kit number."
        },
        {
          "property": "ncmc recharge mode",
          "context": "Mode: 'online' or 'offline'."
        },
        {
          "property": "recharge amount",
          "context": "Recharge amount (in subcurrency)."
        }
      ],
      "notes": "Properties are derived from `OfflineCardRechargeViewState.toAnalyticsParamsMap()`; note that NCMC uses spaced keys like `card no` and `recharge amount`."
    },
    {
      "name": "ncmc offline recharge success",
      "component": "OfflineCardRechargeComponent",
      "stage": "NCMC Offline Recharge",
      "source": "ncmc offline balance recharge screen",
      "description": "NCMC offline recharge successful.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        }
      ],
      "notes": "Properties are derived from `OfflineCardRechargeViewState.toAnalyticsParamsMap()`."
    },
    {
      "name": "ncmc online recharge completed",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "NCMC online recharge flow completed."
    },
    {
      "name": "ncmc online recharge order created",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "NCMC online recharge order created successfully.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        },
        {
          "property": "orderId",
          "context": "Backend order ID."
        }
      ],
      "notes": "Properties are derived from `NCMCOnlineRechargeViewState.toAnalyticsParamsMap()` plus `orderId`."
    },
    {
      "name": "ncmc recharge api error",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "NCMC recharge API call failed.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        },
        {
          "property": "failureReason",
          "context": "Error message from API."
        }
      ],
      "notes": "Properties are derived from `NCMCOnlineRechargeViewState.toAnalyticsParamsMap()` plus `failureReason`."
    },
    {
      "name": "ncmc recharge api error",
      "component": "OfflineCardRechargeComponent",
      "stage": "NCMC Offline Recharge",
      "source": "ncmc offline balance recharge screen",
      "description": "NCMC recharge API call failed.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        },
        {
          "property": "failureReason",
          "context": "Error message from API."
        }
      ],
      "notes": "Properties are derived from `OfflineCardRechargeViewState.toAnalyticsParamsMap()` plus `failureReason`."
    },
    {
      "name": "ncmc recharge payment failed",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "postPaymentScreen",
      "description": "NCMC recharge payment failed."
    },
    {
      "name": "ncmc recharge payment successful",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "postPaymentScreen",
      "description": "NCMC recharge payment completed successfully."
    },
    {
      "name": "ncmc tap operation failure",
      "component": "ProcessUvikResultUseCase",
      "stage": "NCMC Tap Operations",
      "source": "ncmc tap screen",
      "description": "NCMC tap operation failed.",
      "properties": [
        {
          "property": "errorCode",
          "context": "Error code from tap operation."
        },
        {
          "property": "reason",
          "context": "Failure message."
        }
      ]
    },
    {
      "name": "ncmc tap operation result unavailable",
      "component": "ProcessUvikResultUseCase",
      "stage": "NCMC Tap Operations",
      "source": "ncmc tap screen",
      "description": "NCMC tap operation result is unavailable.",
      "properties": [
        {
          "property": "reason",
          "context": "Unavailable reason."
        }
      ]
    },
    {
      "name": "ncmc tap operation success",
      "component": "ProcessUvikResultUseCase",
      "stage": "NCMC Tap Operations",
      "source": "ncmc tap screen",
      "description": "NCMC tap operation completed successfully.",
      "properties": [
        {
          "property": "transactionId",
          "context": "Uvik transaction ID."
        },
        {
          "property": "rrn",
          "context": "Retrieval Reference Number."
        },
        {
          "property": "offlineBalance",
          "context": "Offline balance after tap."
        },
        {
          "property": "topUpAmount",
          "context": "Amount topped up."
        },
        {
          "property": "status",
          "context": "Verification status."
        },
        {
          "property": "resultCode",
          "context": "Result code."
        },
        {
          "property": "message",
          "context": "Result message."
        }
      ]
    },
    {
      "name": "ncmc tap transaction failed",
      "component": "ProcessUvikResultUseCase",
      "stage": "NCMC Tap Operations",
      "source": "ncmc tap screen",
      "description": "NCMC tap transaction failed during processing.",
      "properties": [
        {
          "property": "status",
          "context": "Transaction status: Terminated, Declined, Failed, SelectNext, Unknown."
        }
      ]
    },
    {
      "name": "ncmc tnc accepted loading",
      "component": "NCMCOnlineRechargeComponent",
      "stage": "NCMC Online Recharge",
      "source": "ncmc online recharge screen",
      "description": "User accepts terms and conditions, proceeding to order creation.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        }
      ],
      "notes": "Properties are derived from `NCMCOnlineRechargeViewState.toAnalyticsParamsMap()`."
    },
    {
      "name": "ncmc tnc accepted loading",
      "component": "OfflineCardRechargeComponent",
      "stage": "NCMC Offline Recharge",
      "source": "ncmc offline balance recharge screen",
      "description": "User accepts terms and conditions, proceeding to order creation.",
      "properties": [
        {
          "property": "online recharge balance"
        },
        {
          "property": "card no"
        },
        {
          "property": "kit no"
        },
        {
          "property": "ncmc recharge mode"
        },
        {
          "property": "recharge amount"
        }
      ],
      "notes": "Properties are derived from `OfflineCardRechargeViewState.toAnalyticsParamsMap()`."
    },
    {
      "name": "no linked chalo card found",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User has no linked Chalo Card.",
      "properties": [
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        }
      ],
      "notes": "Raised via `AnalyticsEventConstants.NO_LINKED_CHALO_CARD_FOUND`. Card details may be unavailable; `maskedCardNumber` can be empty."
    },
    {
      "name": "ocr card validity checked",
      "component": "EnterCardDetailsComponent",
      "stage": "Enter Card Details",
      "source": "chalo enter card details screen",
      "description": "Card validity check result after entering card details.",
      "properties": [
        {
          "property": "isSuccessful",
          "context": "Whether validation succeeded."
        },
        {
          "property": "cardNo",
          "context": "Card number validated."
        },
        {
          "property": "rechargeLimit",
          "context": "Recharge limit returned if valid."
        }
      ]
    },
    {
      "name": "ocr cardDetails next clicked",
      "component": "EnterCardDetailsComponent",
      "stage": "Enter Card Details",
      "source": "chalo enter card details screen",
      "description": "User submits card number for validation before recharge.",
      "properties": [
        {
          "property": "cardNo",
          "context": "Card number entered."
        }
      ]
    },
    {
      "name": "ocr homescreen card recharge card",
      "component": "HomeScreen",
      "stage": "Home & Navigation",
      "source": "homeScreen",
      "description": "User taps the card recharge card on home screen."
    },
    {
      "name": "ocr order created",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Recharge order created successfully.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "orderId",
          "context": "Backend order ID."
        },
        {
          "property": "chaloOrderId",
          "context": "Chalo order ID."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `orderId` and `chaloOrderId`."
    },
    {
      "name": "ocr order creation failed",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Order creation failed.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "failureReason",
          "context": "Failure message from backend."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `failureReason`."
    },
    {
      "name": "ocr payment success activity open",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Post-Payment",
      "source": "chalo card recharge enter amount screen",
      "description": "Payment success screen opens after successful recharge payment.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "cardTransactionId",
          "context": "Transaction ID for the recharge."
        },
        {
          "property": "ocr recharge delay copy",
          "context": "Copy text about recharge delay."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `cardTransactionId` and `ocr recharge delay copy`."
    },
    {
      "name": "ocr payment success ok clicked",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Post-Payment",
      "source": "chalo card recharge enter amount screen",
      "description": "User taps OK on payment success screen.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "cardTransactionId"
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `cardTransactionId`."
    },
    {
      "name": "ocr payment success recharge details clicked",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Post-Payment",
      "source": "chalo card recharge enter amount screen",
      "description": "User taps to view recharge details from payment success screen.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "cardTransactionId"
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `cardTransactionId`."
    },
    {
      "name": "ocr payment summary activity open",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Post-Payment",
      "source": "chalo card recharge enter amount screen",
      "description": "Payment summary screen opens with transaction details.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "configId"
        },
        {
          "property": "cardTransactionId"
        },
        {
          "property": "paymentTime",
          "context": "Timestamp of payment."
        },
        {
          "property": "paymentStatus",
          "context": "Payment status."
        },
        {
          "property": "rechargeStatus",
          "context": "Recharge status."
        },
        {
          "property": "amount",
          "context": "Recharge amount."
        }
      ],
      "notes": "Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus payment/recharge summary fields."
    },
    {
      "name": "ocr recharge amount error",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Validation error with entered recharge amount.",
      "properties": [
        {
          "property": "errorType",
          "context": "Type of error: below min, not in multiples, or limit exceeded."
        }
      ]
    },
    {
      "name": "online card recharge payment failed",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "postPaymentScreen",
      "description": "Online card recharge payment failed."
    },
    {
      "name": "online card recharge payment successful",
      "component": "CheckoutComponent",
      "stage": "Checkout Payment (Card)",
      "source": "postPaymentScreen",
      "description": "Online card recharge payment completed successfully."
    },
    {
      "name": "refresh chalo card info clicked",
      "component": "ChaloCardInfoComponent",
      "stage": "Chalo Card Info",
      "source": "chalo card info screen",
      "description": "User taps refresh to reload card information.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "passDescription"
        },
        {
          "property": "refreshChaloCardInfoSource",
          "context": "Source that triggered the refresh."
        }
      ],
      "notes": "Includes the standard `ChaloCardInfoViewState.toAnalyticsPropertiesMap()` properties plus `refreshChaloCardInfoSource`."
    },
    {
      "name": "terms and conditions open",
      "component": "ChaloCardRechargeAmountComponent",
      "stage": "Chalo Card Recharge Amount",
      "source": "chalo card recharge enter amount screen",
      "description": "Terms and conditions dialog shown before order creation.",
      "properties": [
        {
          "property": "cardNumber"
        },
        {
          "property": "maskedCardNumber"
        },
        {
          "property": "isCardRechargeEnabled"
        },
        {
          "property": "rechargeLimit"
        },
        {
          "property": "cardType"
        },
        {
          "property": "cardIssuedOn"
        },
        {
          "property": "cardBalance"
        },
        {
          "property": "isCardBlocked"
        },
        {
          "property": "configId"
        },
        {
          "property": "productName"
        },
        {
          "property": "isActive"
        },
        {
          "property": "productType"
        },
        {
          "property": "productSubType"
        },
        {
          "property": "cardAgency"
        },
        {
          "property": "cardCity"
        },
        {
          "property": "rechargeAmount",
          "context": "Amount user wants to recharge (in subcurrency)."
        }
      ],
      "notes": "Raised via `AnalyticsEventConstants.TERMS_DIALOG_OPEN` (event name is `terms and conditions open`). Includes recharge amount view-state properties from `ChaloCardRechargeAmountViewState.toAnalyticsPropertiesMap()` plus `rechargeAmount`."
    },
    {
      "name": "ocr tutorial bottomsheet displayed",
      "component": "HomeScreenAnalyticsHelperImpl",
      "stage": "Home & Navigation",
      "source": "home screen",
      "description": "Online card recharge tutorial bottomsheet displayed."
    },
    {
      "name": "ocr tutorial bottomsheet next clicked",
      "component": "HomeScreenAnalyticsHelperImpl",
      "stage": "Home & Navigation",
      "source": "home screen",
      "description": "User clicks next on online card recharge tutorial bottomsheet."
    },
    {
      "name": "uvik intent hash creation failed",
      "component": "GenerateUvikIntentHashUseCase",
      "stage": "NCMC Tap Operations",
      "source": "ncmc tap screen",
      "description": "Failed to create intent hash for UVIK tap operation.",
      "properties": [
        {
          "property": "reason",
          "context": "Exception message."
        }
      ]
    }
  ],
  "diagram": {
    "type": "multi-path",
    "notes": "Card flow has multiple independent paths: Chalo Card management (link/recharge/transactions), NCMC online/offline recharge, and NCMC tap operations. Users can enter from home screen or drawer and follow different paths based on card type.",
    "steps": []
  }
}
