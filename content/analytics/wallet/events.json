{
  "flowId": "wallet",
  "flowName": "Chalo Wallet Operations",
  "description": "Complete analytics map for wallet balance viewing, load money, transactions, Quick Pay, and wallet access/KYC flows.",
  "propertyDefinitions": {
    "walletId": {
      "type": "string",
      "description": "Unique identifier for the user's wallet."
    },
    "walletBalance": {
      "type": "number",
      "description": "Current wallet balance amount in currency units."
    },
    "walletStatus": {
      "type": "string",
      "description": "Current status of the wallet.",
      "values": [
        "USER_NOT_LOGGED_IN",
        "DOES_NOT_EXIST",
        "REQUIRES_KYC",
        "MIN_KYC_PENDING",
        "BLOCKED",
        "REQUIRES_BACKEND_RECLAIM",
        "ACTIVE"
      ]
    },
    "walletLoadAmount": {
      "type": "string",
      "description": "Amount entered by user to load into wallet."
    },
    "loadSuggestedAmount": {
      "type": "array",
      "description": "List of suggested denominations shown to the user."
    },
    "wallet suggested amount": {
      "type": "string",
      "description": "Specific suggested denomination selected by the user."
    },
    "kycDone": {
      "type": "boolean",
      "description": "Whether KYC has been completed for the wallet."
    },
    "walletSyncFailureReason": {
      "type": "string",
      "description": "Reason why wallet sync failed after recharge."
    },
    "rechargeOrderFailureReason": {
      "type": "string",
      "description": "Reason why recharge order creation failed."
    },
    "clicked transaction id": {
      "type": "string",
      "description": "Transaction ID of the clicked transaction in the list."
    },
    "wallet balance transaction title": {
      "type": "string",
      "description": "Transaction title, but currently overwritten by transaction status due to a constants typo (see code bug notes)."
    },
    "wallet balance transaction date": {
      "type": "string",
      "description": "Formatted date when the transaction occurred."
    },
    "wallet balance transaction type": {
      "type": "string",
      "description": "Type of wallet transaction.",
      "values": [
        "QUICK_PAY",
        "LOAD_MONEY",
        "CHALO_PAY"
      ]
    },
    "wallet balance orderId": {
      "type": "string",
      "description": "Order ID or booking ID associated with the transaction."
    },
    "wallet balance time long": {
      "type": "number",
      "description": "Unix timestamp of when the transaction occurred."
    },
    "wallet balance transaction amount": {
      "type": "number",
      "description": "Amount of the transaction in currency units."
    },
    "wallet transaction summary amount": {
      "type": "number",
      "description": "Transaction amount shown in the summary screen."
    },
    "wallet transaction summary time": {
      "type": "string",
      "description": "Formatted time of the transaction in the summary."
    },
    "wallet transaction summary orderId": {
      "type": "string",
      "description": "Order ID shown in the transaction summary."
    },
    "wallet transaction summary transaction type": {
      "type": "string",
      "description": "Transaction type shown in summary (QUICK_PAY/LOAD_MONEY/CHALO_PAY)."
    },
    "wallet transaction summary transaction status": {
      "type": "string",
      "description": "Transaction status shown in summary screen."
    },
    "wallet transaction summary mode of payment": {
      "type": "string",
      "description": "Payment mode used for the transaction (UPI, Card, NetBanking, etc.)."
    },
    "walletAccessBottomSheetType": {
      "type": "string",
      "description": "Type of wallet access bottom sheet shown to the user."
    },
    "is chalo wallet activated": {
      "type": "boolean",
      "description": "Whether the Chalo wallet is currently activated for the user."
    },
    "wallet banner url": {
      "type": "string",
      "description": "Image URL of the promotional banner rendered in wallet screens."
    },
    "wallet banner deeplink": {
      "type": "string",
      "description": "Deeplink URL associated with the promotional banner."
    },
    "isSuccessful": {
      "type": "boolean",
      "description": "Whether the wallet migration operation succeeded."
    },
    "error name": {
      "type": "string",
      "description": "Name of the error that occurred during wallet migration."
    },
    "chalo pay bottom sheet amount": {
      "type": "string",
      "description": "Amount being paid through Quick Pay bottom sheet."
    },
    "chalo pay bottom sheet wallet balance left": {
      "type": "number",
      "description": "Remaining wallet balance after the Quick Pay transaction."
    },
    "chalo pay trip amount": {
      "type": "string",
      "description": "Amount entered for the Quick Pay trip."
    },
    "chalo pay trip amount fragment next button clicked failure message": {
      "type": "string",
      "description": "Error message when Quick Pay trip amount next button click fails."
    },
    "min kyc name": {
      "type": "string",
      "description": "Name entered by the user during minimum KYC flow."
    },
    "min kyc otp failure": {
      "type": "string",
      "description": "Reason for OTP verification failure during minimum KYC."
    },
    "min kyc detail radio button status": {
      "type": "string",
      "description": "Status of the radio button selection in minimum KYC details."
    },
    "chaloPayWalletState": {
      "type": "string",
      "description": "State of the wallet in ChaloPayV3 flow."
    },
    "chaloPayWalletBalance": {
      "type": "string",
      "description": "Wallet balance in ChaloPayV3 flow."
    },
    "bottomsheetCTA": {
      "type": "string",
      "description": "CTA action triggered from the ChaloPayV3 bottom sheet."
    },
    "failureReason": {
      "type": "string",
      "description": "Failure reason message (typically from backend / SDK)."
    },
    "orderId": {
      "type": "string",
      "description": "Order ID for Quick Pay / wallet-related orders."
    },
    "activationTime": {
      "type": "number",
      "description": "Activation timestamp (epoch millis) for Quick Pay order."
    },
    "payload": {
      "type": "string",
      "description": "Raw payload string captured for debugging/diagnostics."
    },
    "isChaloPay": {
      "type": "boolean",
      "description": "Whether the validation/receipt event corresponds to a Quick Pay (Chalo Pay) order."
    },
    "productId": {
      "type": "string",
      "description": "Product ID (Quick Pay order/product identifier) used in validation/receipt flows."
    },
    "productType": {
      "type": "string",
      "description": "Product type identifier."
    },
    "productSubType": {
      "type": "string",
      "description": "Product sub-type identifier."
    },
    "punchTime": {
      "type": "number",
      "description": "Punch timestamp (epoch millis) for validation."
    },
    "vehicleNo": {
      "type": "string",
      "description": "Vehicle number associated with the trip."
    },
    "route name": {
      "type": "string",
      "description": "Route name for the Quick Pay trip receipt."
    },
    "startStop": {
      "type": "string",
      "description": "Start stop name for the trip."
    },
    "endStop": {
      "type": "string",
      "description": "End stop name for the trip."
    },
    "conductorId": {
      "type": "string",
      "description": "Conductor identifier from receipt/validation."
    },
    "endStopId": {
      "type": "string",
      "description": "End stop ID from receipt/validation."
    },
    "userId": {
      "type": "string",
      "description": "User identifier (currently phone number for Min KYC flows)."
    },
    "referenceNumber": {
      "type": "string",
      "description": "Reference number for Min KYC OTP / registration."
    },
    "errorBottomSheetCtaType": {
      "type": "string",
      "description": "CTA type shown on the Min KYC error bottom sheet."
    },
    "reason": {
      "type": "string",
      "description": "Failure reason (Min KYC activation failed)."
    },
    "isInvalidOtpEntered": {
      "type": "string",
      "description": "Whether the entered OTP was invalid (stringified boolean)."
    },
    "is foreground": {
      "type": "boolean",
      "description": "Whether the app was in foreground when the event was raised."
    }
  },
  "stages": [
    {
      "name": "Wallet Onboarding",
      "description": "Wallet/ChaloPay intro prompt entry and CTA to open wallet.",
      "events": [
        "wallet onBoarding bottom sheet positive button clicked"
      ]
    },
    {
      "name": "Wallet Balance View",
      "description": "User opens wallet screen, views balance, recent transactions, and promotional banners.",
      "events": [
        "wallet balance fragment opened",
        "wallet banner rendered",
        "wallet banner clicked",
        "wallet balance add money clicked",
        "wallet balance see all transaction clicked",
        "wallet all transaction event clicked"
      ]
    },
    {
      "name": "Load Money Flow",
      "description": "User loads money into wallet: enter amount, pick denomination, proceed, place recharge order, sync failures.",
      "events": [
        "wallet load balance enter amount fragment opened",
        "wallet banner rendered",
        "wallet banner clicked",
        "wallet suggested amount clicked",
        "wallet load balance fragment next button clicked",
        "load money wallet recharge order success",
        "load money wallet recharge order failed",
        "load money wallet sync failed"
      ]
    },
    {
      "name": "All Transactions View",
      "description": "User views transaction history and clicks on specific transactions.",
      "events": [
        "wallet all transaction fragment opened",
        "wallet all transaction event clicked"
      ]
    },
    {
      "name": "Transaction Summary",
      "description": "User views detailed summary of a specific wallet transaction.",
      "events": [
        "wallet transaction summary fragment opened",
        "wallet transaction summary ui model data fetched"
      ]
    },
    {
      "name": "Wallet Access & KYC",
      "description": "Wallet access status checks, activation flows, KYC requirements, and wallet migration.",
      "events": [
        "process wallet access status",
        "wallet access bottom sheet opened",
        "activate wallet clicked",
        "wallet load money clicked",
        "refresh wallet clicked",
        "wallet blocked know more clicked",
        "full kyc know more clicked",
        "post device id for wallet migration",
        "auto reclaim for wallet migration"
      ]
    },
    {
      "name": "Minimum KYC",
      "description": "Minimum KYC flow for wallet activation - details screen, OTP verification, error/success states.",
      "events": [
        "min kyc detail opened",
        "min kyc detail proceed button clicked",
        "min kyc otp fragment opened",
        "min kyc otp resend sms clicked",
        "min kyc otp proceed button clicked",
        "min kyc otp success",
        "min kyc otp failure",
        "min kyc activation failed",
        "min kyc error bottom sheet opened",
        "min kyc error bottom sheet cta clicked",
        "min kyc user registered bottom sheet opened"
      ]
    },
    {
      "name": "Quick Pay (ChaloPayV2)",
      "description": "Quick Pay purchase and post-purchase events (trip amount, bottom sheet confirmation, order creation, punch/receipt).",
      "events": [
        "pay for ticket screen opened",
        "find fare card clicked",
        "chalo pay card clicked",
        "chalo pay trip amount fragment opened",
        "chalo pay trip amount fragment next button clicked",
        "chalo pay trip amount fragment next button clicked failure",
        "chalo pay trip amount fragment chalo pay history clicked",
        "chalo pay bottom sheet fragment opened",
        "chalo pay bottom sheet fragment next button clicked",
        "chalo pay bottom sheet recharge button clicked",
        "chalo pay prerequisites failed",
        "chalo pay order created",
        "quickpay receipt payload",
        "chalo pay punch received",
        "chalo pay ticket punched",
        "chalo pay receipt shown",
        "chalo pay view receipt clicked"
      ]
    },
    {
      "name": "ChaloPayV3",
      "description": "Alternative ChaloPayV3 entry point with its own bottom sheet and payment flow.",
      "events": [
        "chaloPayItemRendered",
        "chaloPayItemClicked",
        "chaloPayBottomsheetOpened",
        "chaloPayBottomsheetTncClicked",
        "chaloPayBottomsheetConfirmPaymentClicked",
        "chaloPayBottomsheetRechargeClicked",
        "chaloPayOrderCreationSuccess",
        "chaloPayOrderCreationFailed",
        "chaloPayPaymentSuccess",
        "chaloPayPaymentFailed"
      ]
    },
    {
      "name": "Background Sync",
      "description": "Background wallet sync operations to keep balance updated.",
      "events": [
        "wallet sync worker started",
        "wallet sync worker result",
        "wallet sync result"
      ]
    }
  ],
  "events": [
    {
      "name": "wallet onBoarding bottom sheet positive button clicked",
      "component": "ProfileScreenComponent",
      "stage": "Wallet Onboarding",
      "source": "profile screen (ChaloPay intro bottom sheet)",
      "description": "User clicked the CTA on the ChaloPay/Wallet intro bottom sheet shown from Profile screen.",
      "properties": []
    },
    {
      "name": "wallet balance fragment opened",
      "component": "WalletBalanceComponent",
      "stage": "Wallet Balance View",
      "source": "app.chalo.wallet.ui.mainbalance.WalletBalanceComponent",
      "description": "Main wallet balance screen opened, showing current balance and recent transactions.",
      "properties": []
    },
    {
      "name": "wallet banner rendered",
      "component": "WalletBalanceComponent, WalletLoadBalanceEnterAmountComponent",
      "stage": "Wallet Balance View",
      "source": "wallet screen components",
      "description": "Promotional banner rendered on wallet screens (Wallet Balance and Load Money).",
      "properties": [
        {
          "property": "wallet banner url",
          "context": "Image URL of the banner"
        },
        {
          "property": "wallet banner deeplink",
          "context": "Deeplink URL for banner click action"
        }
      ]
    },
    {
      "name": "wallet banner clicked",
      "component": "WalletBalanceComponent, WalletLoadBalanceEnterAmountComponent",
      "stage": "Wallet Balance View",
      "source": "wallet screen components",
      "description": "User clicked promotional banner on wallet screens (Wallet Balance and Load Money).",
      "properties": []
    },
    {
      "name": "wallet balance add money clicked",
      "component": "WalletBalanceComponent",
      "stage": "Wallet Balance View",
      "source": "app.chalo.wallet.ui.mainbalance.WalletBalanceComponent",
      "description": "User clicked on 'Add Money' button to load balance.",
      "properties": []
    },
    {
      "name": "wallet balance see all transaction clicked",
      "component": "WalletBalanceComponent",
      "stage": "Wallet Balance View",
      "source": "app.chalo.wallet.ui.mainbalance.WalletBalanceComponent",
      "description": "User clicked 'See All' to view complete transaction history.",
      "properties": []
    },
    {
      "name": "wallet all transaction event clicked",
      "component": "WalletBalanceComponent, WalletAllTransactionsComponent",
      "stage": "All Transactions View",
      "source": "wallet transaction components",
      "description": "User clicked on a specific transaction to view details (can be from Wallet Balance list or All Transactions list).",
      "properties": [
        {
          "property": "clicked transaction id",
          "context": "ID of the clicked transaction"
        },
        {
          "property": "wallet balance transaction title",
          "context": "Currently overwritten by transaction status due to a constants typo; title is not reliably available."
        },
        {
          "property": "wallet balance transaction date",
          "context": "Formatted transaction date"
        },
        {
          "property": "wallet balance transaction type",
          "context": "QUICK_PAY, LOAD_MONEY, or CHALO_PAY"
        },
        {
          "property": "wallet balance orderId",
          "context": "Order or booking ID"
        },
        {
          "property": "wallet balance transaction amount",
          "context": "Transaction amount (only in WalletAllTransactionsComponent)"
        },
        {
          "property": "wallet balance time long",
          "context": "Unix timestamp"
        }
      ]
    },
    {
      "name": "wallet load balance enter amount fragment opened",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "Load money screen opened where user enters amount to load.",
      "properties": [
        {
          "property": "kycDone",
          "context": "Whether KYC is completed"
        }
      ]
    },
    {
      "name": "wallet suggested amount clicked",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "User selected a suggested denomination amount.",
      "properties": [
        {
          "property": "wallet suggested amount",
          "context": "Selected suggested amount value"
        }
      ]
    },
    {
      "name": "wallet load balance fragment next button clicked",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "User clicked next button to proceed with loading the entered amount.",
      "properties": [
        {
          "property": "walletLoadAmount",
          "context": "Amount entered by user"
        },
        {
          "property": "loadSuggestedAmount",
          "context": "List of suggested amounts shown"
        }
      ]
    },
    {
      "name": "load money wallet recharge order success",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "Recharge order successfully created on the backend.",
      "properties": [
        {
          "property": "walletLoadAmount",
          "context": "Amount for which order was created"
        }
      ]
    },
    {
      "name": "load money wallet recharge order failed",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "Recharge order creation failed.",
      "properties": [
        {
          "property": "rechargeOrderFailureReason",
          "context": "Reason for order creation failure"
        }
      ]
    },
    {
      "name": "load money wallet sync failed",
      "component": "WalletLoadBalanceEnterAmountComponent",
      "stage": "Load Money Flow",
      "source": "app.chalo.wallet.ui.loadbalance.WalletLoadBalanceEnterAmountComponent",
      "description": "Wallet balance sync failed after payment completion.",
      "properties": [
        {
          "property": "walletSyncFailureReason",
          "context": "Reason for wallet sync failure"
        }
      ]
    },
    {
      "name": "wallet all transaction fragment opened",
      "component": "WalletAllTransactionsComponent",
      "stage": "All Transactions View",
      "source": "app.chalo.wallet.ui.alltransactions.WalletAllTransactionsComponent",
      "description": "Complete transaction history screen opened.",
      "properties": []
    },
    {
      "name": "wallet transaction summary fragment opened",
      "component": "WalletTransactionSummaryComponent",
      "stage": "Transaction Summary",
      "source": "app.chalo.wallet.ui.transactionsummary.WalletTransactionSummaryComponent",
      "description": "Transaction detail summary screen opened.",
      "properties": []
    },
    {
      "name": "wallet transaction summary ui model data fetched",
      "component": "WalletTransactionSummaryComponent",
      "stage": "Transaction Summary",
      "source": "app.chalo.wallet.ui.transactionsummary.WalletTransactionSummaryComponent",
      "description": "Transaction detail data successfully fetched and displayed.",
      "properties": [
        {
          "property": "wallet transaction summary amount",
          "context": "Transaction amount"
        },
        {
          "property": "wallet transaction summary time",
          "context": "Formatted transaction time"
        },
        {
          "property": "wallet transaction summary orderId",
          "context": "Order ID"
        },
        {
          "property": "wallet transaction summary transaction type",
          "context": "QUICK_PAY, LOAD_MONEY, or CHALO_PAY"
        },
        {
          "property": "wallet transaction summary transaction status",
          "context": "Transaction status"
        },
        {
          "property": "wallet transaction summary mode of payment",
          "context": "Payment mode used"
        }
      ]
    },
    {
      "name": "process wallet access status",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "Wallet access status check and processing result.",
      "properties": [
        {
          "property": "walletStatus",
          "context": "Current wallet status (USER_NOT_LOGGED_IN, DOES_NOT_EXIST, REQUIRES_KYC, MIN_KYC_PENDING, BLOCKED, REQUIRES_BACKEND_RECLAIM, ACTIVE)"
        }
      ]
    },
    {
      "name": "wallet access bottom sheet opened",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "Wallet access information bottom sheet displayed.",
      "properties": [
        {
          "property": "walletAccessBottomSheetType",
          "context": "Type of access bottom sheet shown"
        }
      ]
    },
    {
      "name": "activate wallet clicked",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "User clicked button to activate wallet.",
      "properties": []
    },
    {
      "name": "wallet load money clicked",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "User clicked load money from access bottom sheet.",
      "properties": []
    },
    {
      "name": "refresh wallet clicked",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "User clicked refresh to update wallet status.",
      "properties": []
    },
    {
      "name": "wallet blocked know more clicked",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "User clicked 'Know More' when wallet is blocked.",
      "properties": []
    },
    {
      "name": "full kyc know more clicked",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "User clicked 'Know More' for full KYC information.",
      "properties": []
    },
    {
      "name": "post device id for wallet migration",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "Device ID posted for wallet migration process.",
      "properties": [
        {
          "property": "isSuccessful",
          "context": "Whether posting device ID succeeded"
        }
      ]
    },
    {
      "name": "auto reclaim for wallet migration",
      "component": "WalletAccessManagerImpl",
      "stage": "Wallet Access & KYC",
      "source": "wallet access base fragment",
      "description": "Automatic wallet reclaim attempted during migration.",
      "properties": [
        {
          "property": "isSuccessful",
          "context": "Whether auto reclaim succeeded"
        },
        {
          "property": "error name",
          "context": "Error name if reclaim failed"
        }
      ]
    },
    {
      "name": "min kyc detail opened",
      "component": "MinKycComponent",
      "stage": "Minimum KYC",
      "source": "min kyc component",
      "description": "Minimum KYC detail entry screen opened.",
      "properties": []
    },
    {
      "name": "min kyc detail proceed button clicked",
      "component": "MinKycDetailsComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycdetails.MinKycDetailsComponent",
      "description": "User clicked proceed button in KYC details screen.",
      "properties": [
        {
          "property": "min kyc name",
          "context": "Name entered by the user."
        }
      ]
    },
    {
      "name": "min kyc otp fragment opened",
      "component": "MinKycComponent",
      "stage": "Minimum KYC",
      "source": "min kyc component",
      "description": "OTP verification screen opened for minimum KYC.",
      "properties": []
    },
    {
      "name": "min kyc otp resend sms clicked",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "User clicked to resend OTP SMS.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "min kyc otp proceed button clicked",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "User clicked proceed after entering OTP.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "min kyc otp success",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "OTP verification successful for minimum KYC.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "min kyc otp failure",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "OTP verification failed.",
      "properties": [
        {
          "property": "min kyc otp failure",
          "context": "OTP failure message."
        },
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "min kyc activation failed",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "Wallet activation failed after minimum KYC completion.",
      "properties": [
        {
          "property": "reason",
          "context": "Failure reason message."
        },
        {
          "property": "isInvalidOtpEntered",
          "context": "Whether invalid OTP was entered (stringified boolean)."
        }
      ]
    },
    {
      "name": "min kyc error bottom sheet opened",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "Error bottom sheet displayed when minimum KYC flow encounters an error.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        },
        {
          "property": "errorBottomSheetCtaType",
          "context": "CTA type shown on the error bottom sheet."
        }
      ]
    },
    {
      "name": "min kyc error bottom sheet cta clicked",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "User clicked on CTA button in the minimum KYC error bottom sheet.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "min kyc user registered bottom sheet opened",
      "component": "MinKycOtpComponent",
      "stage": "Minimum KYC",
      "source": "app.chalo.kyc.min.ui.minkycotp.MinKycOtpComponent",
      "description": "Bottom sheet displayed when user is already registered with minimum KYC.",
      "properties": [
        {
          "property": "userId",
          "context": "User identifier (currently phone number)."
        },
        {
          "property": "referenceNumber",
          "context": "Reference number for OTP flow."
        }
      ]
    },
    {
      "name": "pay for ticket screen opened",
      "component": "PayForTicketComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "app.chalo.quickpay.ui.payforticket.PayForTicketComponent",
      "description": "Pay For Ticket landing screen opened (entry point that can lead to Quick Pay or Find Fare).",
      "properties": []
    },
    {
      "name": "find fare card clicked",
      "component": "PayForTicketComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "Source.PAY_FOR_TICKET_SCREEN",
      "properties": []
    },
    {
      "name": "chalo pay card clicked",
      "component": "PayForTicketComponent, QuickpayTripAmountComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "pay for ticket / quick pay screens",
      "description": "User clicked the Chalo Pay (Quick Pay) card (entry CTA).",
      "properties": []
    },
    {
      "name": "chalo pay trip amount fragment opened",
      "component": "QuickpayTripAmountComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "Quick Pay trip amount entry screen opened.",
      "properties": []
    },
    {
      "name": "chalo pay trip amount fragment next button clicked",
      "component": "QuickpayTripAmountComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "User clicked next after entering trip amount.",
      "properties": [
        {
          "property": "chalo pay trip amount",
          "context": "Amount entered for trip"
        }
      ]
    },
    {
      "name": "chalo pay trip amount fragment next button clicked failure",
      "component": "QuickpayTripAmountComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "Next button click failed with validation error.",
      "properties": [
        {
          "property": "chalo pay trip amount fragment next button clicked failure message",
          "context": "Error message for failure"
        }
      ]
    },
    {
      "name": "chalo pay trip amount fragment chalo pay history clicked",
      "component": "QuickpayTripAmountComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "User clicked to view Quick Pay history.",
      "properties": []
    },
    {
      "name": "chalo pay bottom sheet fragment opened",
      "component": "QuickPayBottomSheetHelper",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "Quick Pay confirmation bottom sheet opened.",
      "properties": []
    },
    {
      "name": "chalo pay bottom sheet fragment next button clicked",
      "component": "QuickPayBottomSheetHelper",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "User confirmed Quick Pay payment from bottom sheet.",
      "properties": [
        {
          "property": "chalo pay bottom sheet amount",
          "context": "Amount being paid"
        },
        {
          "property": "chalo pay bottom sheet wallet balance left",
          "context": "Remaining balance after payment"
        }
      ]
    },
    {
      "name": "chalo pay bottom sheet recharge button clicked",
      "component": "QuickPayBottomSheetHelper",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "User clicked recharge button from Quick Pay bottom sheet due to insufficient balance.",
      "properties": [
        {
          "property": "chalo pay bottom sheet amount",
          "context": "Amount shown in bottom sheet."
        },
        {
          "property": "chalo pay bottom sheet wallet balance left",
          "context": "Wallet balance left (when available)."
        }
      ]
    },
    {
      "name": "chalo pay prerequisites failed",
      "component": "PayForTicketComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "Quick Pay prerequisites check failed (insufficient balance, wallet not active, etc.).",
      "properties": []
    },
    {
      "name": "chalo pay order created",
      "component": "CreateQuickPayOrderUsecase",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "app.chalo.wallet.domain.CreateQuickPayOrderUsecase",
      "description": "Quick Pay order created and persisted locally; wallet sync work is started.",
      "properties": [
        {
          "property": "orderId",
          "context": "Generated Quick Pay order ID."
        },
        {
          "property": "chalo pay trip amount",
          "context": "Trip amount for the order."
        },
        {
          "property": "activationTime",
          "context": "Order activation timestamp (epoch millis)."
        },
        {
          "property": "walletBalance",
          "context": "Wallet balance at time of order creation."
        }
      ]
    },
    {
      "name": "quickpay receipt payload",
      "component": "QuickPayTicketProductValidationConfig",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "app.chalo.quickpay.validation.QuickPayTicketProductValidationConfig",
      "description": "Quick Pay receipt payload captured when processing punch notifications (debug/diagnostic).",
      "properties": [
        {
          "property": "payload",
          "context": "Serialized receipt payload string."
        }
      ]
    },
    {
      "name": "chalo pay punch received",
      "component": "PayForTicketComponent",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "quick pay components",
      "description": "Punch confirmation received from conductor device.",
      "properties": []
    },
    {
      "name": "chalo pay ticket punched",
      "component": "QuickPayTicketAnalyticsManagerValidation",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "validation (receipt data)",
      "description": "Quick Pay ticket punched (validated) event.",
      "properties": [
        {
          "property": "isChaloPay",
          "context": "Always true for these events."
        },
        {
          "property": "productId",
          "context": "Quick Pay product/order ID."
        },
        {
          "property": "punchTime",
          "context": "Punch timestamp."
        },
        {
          "property": "chalo pay trip amount",
          "context": "Trip amount from receipt (can be empty when missing)."
        },
        {
          "property": "vehicleNo",
          "context": "Vehicle number."
        },
        {
          "property": "route name",
          "context": "Route name."
        },
        {
          "property": "startStop",
          "context": "Trip start stop."
        },
        {
          "property": "endStop",
          "context": "Trip end stop."
        },
        {
          "property": "conductorId",
          "context": "Conductor identifier."
        },
        {
          "property": "endStopId",
          "context": "Trip end stop ID."
        }
      ]
    },
    {
      "name": "chalo pay receipt shown",
      "component": "QuickPayTicketAnalyticsManagerValidation",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "validation (receipt screen)",
      "description": "Quick Pay receipt was shown to the user.",
      "properties": [
        {
          "property": "productId",
          "context": "Quick Pay product/order ID."
        },
        {
          "property": "productType",
          "context": "Product type."
        },
        {
          "property": "productSubType",
          "context": "Product sub-type."
        },
        {
          "property": "isSuccessful",
          "context": "Whether showing receipt succeeded."
        }
      ]
    },
    {
      "name": "chalo pay view receipt clicked",
      "component": "QuickPayTicketAnalyticsManagerValidation",
      "stage": "Quick Pay (ChaloPayV2)",
      "source": "validation (receipt data)",
      "description": "User clicked to view Quick Pay receipt.",
      "properties": [
        {
          "property": "isChaloPay",
          "context": "Always true for these events."
        },
        {
          "property": "productId",
          "context": "Quick Pay product/order ID."
        },
        {
          "property": "punchTime",
          "context": "Punch timestamp."
        },
        {
          "property": "chalo pay trip amount",
          "context": "Trip amount from receipt (can be empty when missing)."
        },
        {
          "property": "vehicleNo",
          "context": "Vehicle number."
        },
        {
          "property": "route name",
          "context": "Route name."
        },
        {
          "property": "startStop",
          "context": "Trip start stop."
        },
        {
          "property": "endStop",
          "context": "Trip end stop."
        },
        {
          "property": "conductorId",
          "context": "Conductor identifier."
        },
        {
          "property": "endStopId",
          "context": "Trip end stop ID."
        }
      ]
    },
    {
      "name": "chaloPayItemRendered",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 item rendered in UI.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        }
      ]
    },
    {
      "name": "chaloPayItemClicked",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "User clicked on ChaloPayV3 item.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        }
      ]
    },
    {
      "name": "chaloPayBottomsheetOpened",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 bottom sheet opened.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        },
        {
          "property": "bottomsheetCTA",
          "context": "CTA action/state (lowercased)."
        }
      ]
    },
    {
      "name": "chaloPayBottomsheetTncClicked",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "User clicked Terms & Conditions in ChaloPayV3 bottom sheet.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        },
        {
          "property": "bottomsheetCTA",
          "context": "CTA action/state (lowercased)."
        }
      ]
    },
    {
      "name": "chaloPayBottomsheetConfirmPaymentClicked",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "User confirmed payment in ChaloPayV3 bottom sheet.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        },
        {
          "property": "bottomsheetCTA",
          "context": "CTA action/state (lowercased)."
        }
      ]
    },
    {
      "name": "chaloPayBottomsheetRechargeClicked",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "User clicked recharge button in ChaloPayV3 bottom sheet.",
      "properties": [
        {
          "property": "chaloPayWalletState",
          "context": "Wallet UI state (lowercased)."
        },
        {
          "property": "chaloPayWalletBalance",
          "context": "Wallet balance (stringified)."
        },
        {
          "property": "bottomsheetCTA",
          "context": "CTA action/state (lowercased)."
        }
      ]
    },
    {
      "name": "chaloPayOrderCreationSuccess",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 order created successfully.",
      "properties": []
    },
    {
      "name": "chaloPayOrderCreationFailed",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 order creation failed.",
      "properties": [
        {
          "property": "failureReason",
          "context": "Failure reason."
        }
      ]
    },
    {
      "name": "chaloPayPaymentSuccess",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 payment completed successfully.",
      "properties": []
    },
    {
      "name": "chaloPayPaymentFailed",
      "component": "ChaloPayV3Component",
      "stage": "ChaloPayV3",
      "source": "chalo pay v3 components",
      "description": "ChaloPayV3 payment failed.",
      "properties": [
        {
          "property": "failureReason",
          "context": "Failure reason."
        }
      ]
    },
    {
      "name": "wallet sync worker started",
      "component": "WalletSyncWorker",
      "stage": "Background Sync",
      "source": "WalletSyncWorker",
      "description": "Background wallet sync worker started.",
      "properties": []
    },
    {
      "name": "wallet sync worker result",
      "component": "WalletSyncWorker",
      "stage": "Background Sync",
      "source": "WalletSyncWorker",
      "description": "Background wallet sync worker completed with result.",
      "properties": [
        {
          "property": "isSuccessful",
          "context": "Whether sync succeeded."
        },
        {
          "property": "error name",
          "context": "Failure reason enum name (empty on success)."
        },
        {
          "property": "walletId",
          "context": "Wallet ID (empty when unavailable)."
        },
        {
          "property": "is foreground",
          "context": "Foreground state at time of event."
        },
        {
          "property": "walletBalance",
          "context": "Wallet remaining balance (empty when unavailable)."
        }
      ]
    },
    {
      "name": "wallet sync result",
      "component": "WalletSyncWorker",
      "stage": "Background Sync",
      "source": "WalletSyncWorker",
      "description": "Wallet sync operation result.",
      "properties": [
        {
          "property": "isSuccessful",
          "context": "Whether sync succeeded."
        },
        {
          "property": "error name",
          "context": "Failure reason enum name (empty on success)."
        },
        {
          "property": "walletId",
          "context": "Wallet ID (empty when unavailable)."
        },
        {
          "property": "walletBalance",
          "context": "Wallet remaining balance (empty when unavailable)."
        },
        {
          "property": "walletStatus",
          "context": "Cached wallet status (empty when unavailable)."
        }
      ]
    }
  ],
  "diagram": {
    "type": "sequence",
    "steps": [
      {
        "label": "Wallet Balance View",
        "events": [
          "wallet balance fragment opened",
          "wallet banner rendered",
          "wallet balance add money clicked"
        ],
        "next": "Load Money or Transactions"
      },
      {
        "label": "Load Money Flow",
        "events": [
          "wallet load balance enter amount fragment opened",
          "wallet suggested amount clicked",
          "wallet load balance fragment next button clicked",
          "load money wallet recharge order success"
        ],
        "next": "Payment & Sync"
      },
      {
        "label": "Transaction View",
        "events": [
          "wallet all transaction fragment opened",
          "wallet all transaction event clicked",
          "wallet transaction summary fragment opened",
          "wallet transaction summary ui model data fetched"
        ]
      },
      {
        "label": "Quick Pay Flow",
        "events": [
          "chalo pay trip amount fragment opened",
          "chalo pay trip amount fragment next button clicked",
          "chalo pay bottom sheet fragment opened",
          "chalo pay bottom sheet fragment next button clicked",
          "chalo pay order created"
        ]
      },
      {
        "label": "Wallet Access & KYC",
        "events": [
          "process wallet access status",
          "wallet access bottom sheet opened",
          "activate wallet clicked"
        ],
        "next": "Minimum KYC if required"
      },
      {
        "label": "Minimum KYC",
        "events": [
          "min kyc detail opened",
          "min kyc otp fragment opened",
          "min kyc otp proceed button clicked",
          "min kyc otp success"
        ]
      },
      {
        "label": "Additional events",
        "events": [
          "find fare card clicked"
        ]
      }
    ],
    "notes": "Wallet flow includes balance viewing, money loading, transaction history, Quick Pay ticket purchase, and wallet activation/KYC. ChaloPayV3 is a parallel entry point with its own flow. Background sync ensures balance is always up-to-date."
  }
}
